execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:-106b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s weapon.offhand foreverworld:no_lodestone

execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:0b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.0 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:1b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.1 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:2b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.2 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:3b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.3 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:4b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.4 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:5b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.5 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:6b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.6 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:7b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.7 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:8b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s hotbar.8 foreverworld:no_lodestone

execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:9b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.0 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:10b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.1 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:11b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.2 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:12b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.3 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:13b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.4 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:14b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.5 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:15b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.6 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:16b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.7 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:17b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.8 foreverworld:no_lodestone

execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:18b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.9 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:19b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.10 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:20b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.11 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:21b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.12 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:22b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.13 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:23b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.14 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:24b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.15 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:25b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.16 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:26b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.17 foreverworld:no_lodestone

execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:27b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.18 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:28b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.19 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:29b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.20 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:30b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.21 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:31b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.22 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:32b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.23 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:33b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.24 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:34b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.25 foreverworld:no_lodestone
execute as @a[tag=foreverworld_lode,nbt={Inventory:[{Slot:35b,id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run item modify entity @s inventory.26 foreverworld:no_lodestone

# we use the foreverworld_lode tag to delay application of the rule by one tick, as updating a compass destination in the same tick will not be seen by the client
execute as @a[tag=foreverworld_lode] run tag @s remove foreverworld_lode
execute as @a[tag=!foreverworld_lode,nbt={Inventory:[{id:"minecraft:compass",tag:{LodestoneTracked:1b}}]}] run tag @s add foreverworld_lode